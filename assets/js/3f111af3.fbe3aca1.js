"use strict";(self.webpackChunkstarlake=self.webpackChunkstarlake||[]).push([[6369],{15680:(e,t,n)=>{n.d(t,{xA:()=>p,yg:()=>m});var a=n(96540);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),d=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(s.Provider,{value:t},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},g=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=d(n),g=r,m=u["".concat(s,".").concat(g)]||u[g]||c[g]||i;return n?a.createElement(m,o(o({ref:t},p),{},{components:n})):a.createElement(m,o({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=g;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:r,o[1]=l;for(var d=2;d<i;d++)o[d]=n[d];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}g.displayName="MDXCreateElement"},1544:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>c,frontMatter:()=>i,metadata:()=>l,toc:()=>d});var a=n(9668),r=(n(96540),n(15680));const i={},o="Load XML files",l={unversionedId:"guides/load/xml",id:"guides/load/xml",title:"Load XML files",description:"Loading XML files is similar to loading JSON files where attributes may have nested or repeated attributes.",source:"@site/docs/0300-guides/200-load/130-xml.mdx",sourceDirName:"0300-guides/200-load",slug:"/guides/load/xml",permalink:"/docs/next/guides/load/xml",draft:!1,editUrl:"https://github.com/starlake-ai/starlake/edit/master/docs/docs/0300-guides/200-load/130-xml.mdx",tags:[],version:"current",sidebarPosition:130,frontMatter:{},sidebar:"starlakeSidebar",previous:{title:"Load JSON Files",permalink:"/docs/next/guides/load/json"},next:{title:"Load fixed width files",permalink:"/docs/next/guides/load/position"}},s={},d=[{value:"Infer schema",id:"infer-schema",level:2},{value:"Parsing XML",id:"parsing-xml",level:2}],p={toc:d},u="wrapper";function c(e){let{components:t,...n}=e;return(0,r.yg)(u,(0,a.A)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("h1",{id:"load-xml-files"},"Load XML files"),(0,r.yg)("p",null,"Loading XML files is similar to loading JSON files where attributes may have nested or repeated attributes.\nthe difference is that in XML, child nodes and ",(0,r.yg)("strong",{parentName:"p"},"node attributes")," are used to represent the nested attributes."),(0,r.yg)("p",null,"Consider the following XML file:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0"?>\n<data>\n    <country name="Liechtenstein">\n        <rank>1</rank>\n        <year>2008</year>\n        <gdppc>141100</gdppc>\n        <neighbor name="Austria" direction="E"/>\n        <neighbor name="Switzerland" direction="W"/>\n    </country>\n    <country name="Singapore">\n        <rank>4</rank>\n        <year>2011</year>\n        <gdppc>59900</gdppc>\n        <neighbor name="Malaysia" direction="N"/>\n    </country>\n</data>\n\n')),(0,r.yg)("p",null,"The parser needs to detect what tag identifies a row. In the example above, the tag ",(0,r.yg)("inlineCode",{parentName:"p"},"country")," identifies a row."),(0,r.yg)("p",null,"Child nodes and node attributes are used to represent the nested attributes. In the example above, the ",(0,r.yg)("inlineCode",{parentName:"p"},"country")," tag will have the following attributes in the database table:"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"_name")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"rank")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"year")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"gdppc")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"neighbor"),(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"_name")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"_direction"))))),(0,r.yg)("p",null,"Note that the ",(0,r.yg)("inlineCode",{parentName:"p"},"_")," prefix is used to differentiate node attributes from child nodes, to avoid name collisions."),(0,r.yg)("br",null),(0,r.yg)("admonition",{type:"note"},(0,r.yg)("p",{parentName:"admonition"},"Also note that the target datawarehouse need to support nested and repeated attributes. For example, BigQuery and Databricks support nested and repeated attributes, while Redshift does not.")),(0,r.yg)("h2",{id:"infer-schema"},"Infer schema"),(0,r.yg)("p",null,"The very first step is to infer the schema of the file from a data file as described in the ",(0,r.yg)("a",{parentName:"p",href:"autoload#how-autoload-detects-the-format-of-the-files"},"autoload section")," before you start customizing your configuration. This is done using the ",(0,r.yg)("inlineCode",{parentName:"p"},"infer-schema")," command. This will bootstrap the configuration file for the table."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-bash"},"\nstarlake infer-schema --input-path incoming/starbake\n\n")),(0,r.yg)("h2",{id:"parsing-xml"},"Parsing XML"),(0,r.yg)("p",null,"You may need to customize the configuration file to parse the XML file.\nThe main options to consider are:"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"rowTag"),": The tag that identifies a row in the XML file."),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"attributePrefix"),": The prefix used to identify node attributes (",(0,r.yg)("inlineCode",{parentName:"li"},"_")," by default)."),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"rowValidationXSDPath"),": The path to the XSD file used to validate the XML file.")),(0,r.yg)("p",null,"Other options are available to customize the parsing of the XML file. You can find the full list of options in the ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/databricks/spark-xml?tab=readme-ov-file#features"},"Spark XML reference"),"."))}c.isMDXComponent=!0}}]);
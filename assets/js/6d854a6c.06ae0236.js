"use strict";(self.webpackChunkstarlake=self.webpackChunkstarlake||[]).push([[4408],{72440:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>i,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>d});var n=a(74848),r=a(28453);const s={},c="Tutorial",o={id:"guides/extract/tutorial",title:"Tutorial",description:"Extract tables in one shot or incrementally from a database as a set of files.",source:"@site/versioned_docs/version-1.2.0/0300-guides/100-extract/100-tutorial.mdx",sourceDirName:"0300-guides/100-extract",slug:"/guides/extract/tutorial",permalink:"/starlake/docs/guides/extract/tutorial",draft:!1,unlisted:!1,editUrl:"https://github.com/starlake-ai/starlake/edit/master/docs/versioned_docs/version-1.2.0/0300-guides/100-extract/100-tutorial.mdx",tags:[],version:"1.2.0",sidebarPosition:100,frontMatter:{},sidebar:"starlakeSidebar",previous:{title:"Extract",permalink:"/starlake/docs/category/extract"},next:{title:"Query extraction",permalink:"/starlake/docs/guides/extract/extract-from-query"}},i={},d=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Extract Data",id:"extract-data",level:2},{value:"Configure the connection to the source database",id:"configure-the-connection-to-the-source-database",level:2},{value:"Extract the data",id:"extract-the-data",level:2},{value:"Extract Schema (Optional)",id:"extract-schema-optional",level:2}];function l(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"tutorial",children:"Tutorial"}),"\n",(0,n.jsx)(t.p,{children:"Extract tables in one shot or incrementally from a database as a set of files."}),"\n",(0,n.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:["Install ",(0,n.jsx)(t.a,{href:"https://duckdb.org/docs/installation/",children:"duckdb"})]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:["Download the ",(0,n.jsx)(t.a,{href:"https://github.com/starlake-ai/starlake/samples/starbake/datasets/duckdb.db",children:"sample duckdb.db"})," database and store it in the ",(0,n.jsx)(t.code,{children:"datasets"})," folder in your project directory ",(0,n.jsx)(t.code,{children:"$SL_ROOT/datasets"})]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"This will bring in the following database schema:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'$ duckdb $SL_ROOT/datasets/duckdb.db\nv0.10.0 20b1486d11\nEnter ".help" for usage hints.\nD show;\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 database \u2502  schema  \u2502    name    \u2502                      column_names                      \u2502                    column_types                     \u2502 temporary \u2502\n\u2502 varchar  \u2502 varchar  \u2502  varchar   \u2502                       varchar[]                        \u2502                      varchar[]                      \u2502  boolean  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 duckdb   \u2502 starbake \u2502 order      \u2502 [customer_id, order_id, status, timestamp]             \u2502 [BIGINT, BIGINT, VARCHAR, TIMESTAMP]                \u2502 false     \u2502\n\u2502 duckdb   \u2502 starbake \u2502 order_line \u2502 [order_id, product_id, quantity, sale_price]           \u2502 [BIGINT, BIGINT, BIGINT, DOUBLE]                    \u2502 false     \u2502\n\u2502 duckdb   \u2502 starbake \u2502 product    \u2502 [category, cost, description, name, price, product_id] \u2502 [VARCHAR, DOUBLE, VARCHAR, VARCHAR, DOUBLE, BIGINT] \u2502 false     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\nD .quit\n$\n'})}),"\n",(0,n.jsx)(t.h2,{id:"extract-data",children:"Extract Data"}),"\n",(0,n.jsx)(t.p,{children:"Extracting Data involves the following steps:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Configure the connection to the source database"}),"\n",(0,n.jsx)(t.li,{children:"Select the database schema to extract"}),"\n",(0,n.jsx)(t.li,{children:"Select the tables to extract"}),"\n",(0,n.jsx)(t.li,{children:"Select the columns to extract (optional)"}),"\n",(0,n.jsx)(t.li,{children:"Select the rows to extract (optional)"}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"configure-the-connection-to-the-source-database",children:"Configure the connection to the source database"}),"\n",(0,n.jsxs)(t.p,{children:["In the project folder, under the ",(0,n.jsx)(t.code,{children:"metadata"})," folder,  edit the file application.sl.yml and set the connection parameters to the source database."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-yaml",metastring:'title="metadata/application.sl.yml"',children:'application:\n  ...\n  connections:\n    duckdb:\n      type: "jdbc" # Connection to DuckDB\n      options:\n        url: "jdbc:duckdb:{{SL_ROOT}}/datasets/duckdb.db" # Location of the DuckDB database\n        driver: "org.duckdb.DuckDBDriver"\n\n  ...\n'})}),"\n",(0,n.jsxs)(t.p,{children:["In the metadata/extract folder, create a new file ",(0,n.jsx)(t.code,{children:"my_extract_config.sl.yml"})," and set the connectionRef to the connection defined in the application.sl.yml file."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-yaml",metastring:'title="metadata/extract/my_extract_config.sl.yml"',children:'extract:\n  connectionRef: "duckdb" # The database connection to use\n  jdbcSchemas:\n    - schema: "starbake"\n      tables:\n        - name: "*"               # table names or  "*" to extract all tables\n      tableTypes:                 # (optional)  table types to extract\n        - "TABLE"\n        #- "VIEW"\n        #- "SYSTEM TABLE"\n        #- "GLOBAL TEMPORARY"\n        #- "LOCAL TEMPORARY"\n        #- "ALIAS"\n        #- "SYNONYM"\n'})}),"\n",(0,n.jsx)(t.p,{children:"That's it! We are ready to extract the data from the database."}),"\n",(0,n.jsx)(t.h2,{id:"extract-the-data",children:"Extract the data"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-shell",children:"$ cd $SL_ROOT\n$ starlake extract-data --config my_extract_config --outputDir $SL_ROOT/incoming/starbake\n"})}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"$SL_ROOT/incoming/starbake"})," folder will contain the extracted data in CSV format."]}),"\n",(0,n.jsxs)(t.p,{children:["You are now ready to load the data into the datawarehouse of your choice using the ",(0,n.jsx)(t.a,{href:"../load/tutorial",children:"starlake load"})," command."]}),"\n",(0,n.jsx)(t.h2,{id:"extract-schema-optional",children:"Extract Schema (Optional)"}),"\n",(0,n.jsx)(t.p,{children:"The command below generates a table schema description file in the metadata/load directory and allows you to load the data into the datawarehouse of your choice,\nusing starlake load command instead of going through the infer-schema feature starlake provides."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"$ cd $SL_ROOT\n$ starlake.sh extract-schema --config my_extract_config.sl.yml # extract description\n"})})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},28453:(e,t,a)=>{a.d(t,{R:()=>c,x:()=>o});var n=a(96540);const r={},s=n.createContext(r);function c(e){const t=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),n.createElement(s.Provider,{value:t},e.children)}}}]);
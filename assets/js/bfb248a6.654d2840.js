"use strict";(self.webpackChunkstarlake=self.webpackChunkstarlake||[]).push([[284],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>f});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var s=r.createContext({}),d=function(e){var t=r.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},u=function(e){var t=d(e.components);return r.createElement(s.Provider,{value:t},e.children)},c="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),c=d(a),m=n,f=c["".concat(s,".").concat(m)]||c[m]||p[m]||o;return a?r.createElement(f,l(l({ref:t},u),{},{components:a})):r.createElement(f,l({ref:t},u))}));function f(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,l=new Array(o);l[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[c]="string"==typeof e?e:n,l[1]=i;for(var d=2;d<o;d++)l[d]=a[d];return r.createElement.apply(null,l)}return r.createElement.apply(null,a)}m.displayName="MDXCreateElement"},63887:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>d});var r=a(87462),n=(a(67294),a(3905));const o={},l="Tutorial",i={unversionedId:"guides/load/tutorial",id:"guides/load/tutorial",title:"Tutorial",description:"Load and validate, in one shot or incrementally, JSON, XML and CSV files into your datawarehouse using different write strategies.",source:"@site/docs/0300-guides/200-load/100-tutorial.mdx",sourceDirName:"0300-guides/200-load",slug:"/guides/load/tutorial",permalink:"/starlake/docs/next/guides/load/tutorial",draft:!1,editUrl:"https://github.com/starlake-ai/starlake/edit/master/docs/docs/0300-guides/200-load/100-tutorial.mdx",tags:[],version:"current",sidebarPosition:100,frontMatter:{},sidebar:"starlakeSidebar",previous:{title:"Load",permalink:"/starlake/docs/next/category/load"},next:{title:"The YAML config File sections",permalink:"/starlake/docs/next/guides/load/schema"}},s={},d=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Infer schema",id:"infer-schema",level:2},{value:"Stage before loading",id:"stage-before-loading",level:2},{value:"Load data into your datawarehouse",id:"load-data-into-your-datawarehouse",level:2},{value:"Query your loaded files in your datawarehouse",id:"query-your-loaded-files-in-your-datawarehouse",level:2},{value:"Apply transformations on the fly",id:"apply-transformations-on-the-fly",level:2},{value:"Customize write strategies",id:"customize-write-strategies",level:2},{value:"Partition your tables",id:"partition-your-tables",level:2}],u={toc:d},c="wrapper";function p(e){let{components:t,...a}=e;return(0,n.kt)(c,(0,r.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"tutorial"},"Tutorial"),(0,n.kt)("p",null,"Load and validate, in one shot or incrementally, JSON, XML and CSV files into your datawarehouse using different write strategies."),(0,n.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,n.kt)("p",null,"If you skipped the extract step above, you can download the data from ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/starlake-ai/starlake/tree/master/samples/starbake/incoming/starbake"},"here"),".\nand copy them to the incoming/starbake folder.\nThe folder contains now three files:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"product.xml"),(0,n.kt)("li",{parentName:"ul"},"order_20240228.json"),(0,n.kt)("li",{parentName:"ul"},"order_line_20240228.csv")),(0,n.kt)("h2",{id:"infer-schema"},"Infer schema"),(0,n.kt)("p",null,"This is done by running the following command:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"starlake infer-schema --input-path incoming/starbake --clean\n")),(0,n.kt)("p",null,"Your metadata ",(0,n.kt)("inlineCode",{parentName:"p"},"load")," folder should now contain the folder ",(0,n.kt)("inlineCode",{parentName:"p"},"starbake")," with following files:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"products.sl.yml"),(0,n.kt)("li",{parentName:"ul"},"orders.sl.yml"),(0,n.kt)("li",{parentName:"ul"},"order_lines.yml"),(0,n.kt)("li",{parentName:"ul"},"_config.sl.yml")),(0,n.kt)("p",null,"The \xecnfer-schema` command has created a schema file for each of the files in the incoming folder trying to detect the schema of the files.\nThese schema files are used to load the data into the datawarehouse."),(0,n.kt)("p",null,"In a real life scenario, you may want to review the schema files and adjust them to your needs."),(0,n.kt)("h2",{id:"stage-before-loading"},"Stage before loading"),(0,n.kt)("p",null,"starlake can stage the files before loading them into the datawarehouse.\nThis is useful when your files arrive in a different folder from the one where they are loaded into the datawarehouse."),(0,n.kt)("p",null,"To move the incoming files to the stage folder. Run the following command:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"starlake stage\n")),(0,n.kt)("h2",{id:"load-data-into-your-datawarehouse"},"Load data into your datawarehouse"),(0,n.kt)("p",null,"Run the following command to load the files in the incoming folder.\nSince we are target teh DuckDB datawarehouse, we need to set the SL_ENV variable to ",(0,n.kt)("inlineCode",{parentName:"p"},"DUCKDB")," to activate the env.DUCKDB.sl.yml configuration file."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"\nSL_ENV=DUCKDB starlake load\n\n")),(0,n.kt)("h2",{id:"query-your-loaded-files-in-your-datawarehouse"},"Query your loaded files in your datawarehouse"),(0,n.kt)("p",null,"That's it you have loaded the data into your datawarehouse and just need to query it.\nTo query your database, you can use the following command:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'$ cd $SL_ROOT\n$ duckdb datasets/duckdb.db\nv0.10.0 20b1486d11\nEnter ".help" for usage hints.\nD show;\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 database \u2502  schema  \u2502      name       \u2502     column_names     \u2502                                           column_types                                            \u2502 temporary \u2502\n\u2502 varchar  \u2502 varchar  \u2502     varchar     \u2502      varchar[]       \u2502                                             varchar[]                                             \u2502  boolean  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 duckdb   \u2502 audit    \u2502 audit           \u2502 [JOBID, PATHS, DOM\u2026  \u2502 [VARCHAR, VARCHAR, VARCHAR, VARCHAR, BOOLEAN, BIGINT, BIGINT, BIGINT, TIMESTAMP, INTEGER, VARCH\u2026  \u2502 false     \u2502\n\u2502 duckdb   \u2502 audit    \u2502 rejected        \u2502 [JOBID, TIMESTAMP,\u2026  \u2502 [VARCHAR, TIMESTAMP, VARCHAR, VARCHAR, VARCHAR, VARCHAR]                                          \u2502 false     \u2502\n\u2502 duckdb   \u2502 starbake \u2502 order           \u2502 [customer_id, orde\u2026  \u2502 [BIGINT, BIGINT, VARCHAR, TIMESTAMP]                                                              \u2502 false     \u2502\n\u2502 duckdb   \u2502 starbake \u2502 order_line      \u2502 [order_id, product\u2026  \u2502 [BIGINT, BIGINT, BIGINT, DOUBLE]                                                                  \u2502 false     \u2502\n\u2502 duckdb   \u2502 starbake \u2502 product         \u2502 [category, cost, d\u2026  \u2502 [VARCHAR, DOUBLE, VARCHAR, VARCHAR, DOUBLE, BIGINT]                                               \u2502 false     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nD select * from starbake.order limit 5;\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 customer_id \u2502 order_id \u2502  status   \u2502        timestamp        \u2502\n\u2502    int64    \u2502  int64   \u2502  varchar  \u2502        timestamp        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502           6 \u2502        1 \u2502 Cancelled \u2502 2024-02-05 22:19:15.454 \u2502\n\u2502          23 \u2502        2 \u2502 Delivered \u2502 2024-01-02 11:44:37.59  \u2502\n\u2502          20 \u2502        3 \u2502 Delivered \u2502 2024-02-10 23:10:30.685 \u2502\n\u2502           6 \u2502        4 \u2502 Delivered \u2502 2024-01-17 19:31:22.917 \u2502\n\u2502          17 \u2502        5 \u2502 Pending   \u2502 2024-01-19 01:26:06.674 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nD .quit\n$\n')),(0,n.kt)("p",null,"Our raw files have been loaded into the datawarehouse and we can now start to ",(0,n.kt)("a",{parentName:"p",href:"../transform/tutorial"},"transform our data to build insights"),"."),(0,n.kt)("h2",{id:"apply-transformations-on-the-fly"},"Apply transformations on the fly"),(0,n.kt)("h2",{id:"customize-write-strategies"},"Customize write strategies"),(0,n.kt)("h2",{id:"partition-your-tables"},"Partition your tables"))}p.isMDXComponent=!0}}]);